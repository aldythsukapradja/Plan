<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Line-Drive Waterflood — Long Horizontals (~30k ft) • Producer in Green</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" />
<style>
  :root{
    /* seaborn-like palette */
    --blue:#4C72B0;   /* injectors & water */
    --green:#55A868;  /* producers & oil */
    --orange:#DD8452; --red:#C44E52; --purple:#8172B3; --brown:#937860; --gray:#8C8C8C;
    /* theme */
    --bg:#0f1320; --panel:#151b2e; --text:#e7edf7; --muted:#b9c3d6; --accent:#3ad1c7;
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.55 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  .wrap{max-width:1200px;margin:auto;padding:28px}
  h1{margin:.2rem 0 0;font-size:1.9rem}
  p.lead{margin:.25rem 0 0;color:var(--muted)}
  .grid{display:grid;gap:18px}
  @media(min-width:1000px){ .grid{grid-template-columns:1.15fr .85fr} }
  .card{background:var(--panel);border:1px solid rgba(255,255,255,.06);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.25)}
  .card h2{margin:0;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.06);font-size:1.1rem}
  .card .content{padding:14px 16px}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:rgba(58,209,199,.12);border:1px solid rgba(58,209,199,.45);color:var(--accent);font-size:.8rem;margin-right:6px}
  .hero{display:flex;gap:16px;align-items:flex-start;justify-content:space-between;flex-wrap:wrap}
  .button{background:linear-gradient(135deg,var(--blue),#6b8ad6);color:#fff;border:none;padding:10px 14px;border-radius:10px;cursor:pointer}
  .muted{color:var(--muted)}
  .tiny{color:var(--muted);font-size:.88rem}
  .controls{display:grid;gap:14px}
  .slider{display:grid;grid-template-columns:140px 1fr 54px;gap:10px;align-items:center}
  input[type="range"]{width:100%}
  .legend{display:flex;gap:16px;flex-wrap:wrap;font-size:.9rem;color:var(--muted);margin-bottom:8px}
  .dot{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:6px}
  .sim{position:relative;width:100%;height:320px;border-radius:12px;background:linear-gradient(#1a1f33,#10162a);overflow:hidden}
  .label{position:absolute;font-size:.85rem;color:var(--muted);text-shadow:0 1px 0 rgba(0,0,0,.5)}
  .injector{position:absolute;width:6px;height:160px;background:var(--blue);top:70px;border-radius:3px;box-shadow:0 0 10px rgba(76,114,176,.35)}
  /* Producer well now GREEN */
  .wellH{position:absolute;height:10px;width:55%;background:var(--green);border-radius:6px;box-shadow:0 0 12px rgba(85,168,104,.25)}
  .front{position:absolute;top:28px;bottom:28px;width:0;background:rgba(76,114,176,.22);
         border-left:2px solid var(--blue);box-shadow:inset 0 0 20px rgba(76,114,176,.35), 0 0 18px rgba(76,114,176,.25)}
  /* front “wiggle” overlay (mobility effect) */
  .wiggle{position:absolute;top:28px;bottom:28px;left:0;width:0;opacity:.28;background:
           repeating-linear-gradient(135deg, rgba(76,114,176,.6), rgba(76,114,176,.6) 6px, rgba(76,114,176,0) 6px, rgba(76,114,176,0) 12px);
           mix-blend-mode:screen;filter:blur(0.6px)}
  .badges{display:flex;gap:8px;flex-wrap:wrap}
  .badge{font-size:.75rem;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);padding:2px 8px;border-radius:7px;color:var(--muted)}
  .two-col{display:grid;gap:16px}
  @media(min-width:900px){ .two-col{grid-template-columns:1fr 1fr} }
  footer{opacity:.8;margin-top:18px;font-size:.9rem}
</style>
</head>
<body>
<div class="wrap">
  <header class="hero">
    <div>
      <div class="pill">Reservoir Management: Line-Drive Flood</div>
      <h1>Waterflooding for Long Horizontal Wells (~30,000 ft drains)</h1>
      <p class="lead">A <b>blue curtain</b> of injected water pushes oil toward very long producers. Oil bumps up first; later the produced liquid has more water (WC rises).</p>
      <div class="badges" style="margin-top:8px">
        <span class="badge">Pattern: Line-Drive</span>
        <span class="badge">Drains: ~30k ft (each)</span>
        <span class="badge">Goal: VRR ≈ 1 (balanced)</span>
      </div>
    </div>
    <div>
      <button id="btnPlay" class="button" style="margin-right:6px">▶ Play</button>
      <button id="btnReset" class="button" style="background:linear-gradient(135deg,var(--purple),#9ea0e0)">↺ Reset</button>
      <div class="tiny" style="margin-top:6px">“Before → After” animation (blue curtain advances)</div>
    </div>
  </header>

  <div class="grid">
    <!-- LEFT: Simulation + Controls -->
    <section class="card">
      <h2>Simulation — Before → After (beginner-friendly)</h2>
      <div class="content">
        <div class="legend">
          <span><span class="dot" style="background:var(--blue)"></span> Injectors (left fence)</span>
          <span><span class="dot" style="background:var(--green)"></span> Producer horizontals (oil out)</span>
        </div>

        <div class="sim" id="sim">
          <!-- injectors fence (left) -->
          <div class="injector" style="left:24px;"></div>
          <div class="injector" style="left:48px;"></div>
          <div class="injector" style="left:72px;"></div>
          <div class="label" style="left:14px; top:8px;">Injectors (water in)</div>

          <!-- moving water front (blue curtain) -->
          <div class="front"  id="front"></div>
          <div class="wiggle" id="wiggle"></div>

          <!-- two long horizontals (right half) — NOW GREEN -->
          <div class="wellH" style="left:46%; top:135px;"></div>
          <div class="wellH" style="left:46%; top:185px;"></div>
          <div class="label" style="right:14px; top:8px;">Producers (oil out)</div>

          <!-- status labels -->
          <div class="label" id="lblStatus" style="left:14px; bottom:8px;">Status: BEFORE (front far; low WC)</div>
          <div class="label" id="lblWC" style="right:14px; bottom:8px;">Water Cut: ~0%</div>
        </div>

        <div class="two-col" style="margin-top:14px">
          <div class="controls">
            <div class="slider">
              <div>Injection rate</div>
              <input id="sInj" type="range" min="0.5" max="1.8" value="1.0" step="0.1">
              <div class="tiny" id="sInjVal">1.0×</div>
            </div>
            <div class="slider">
              <div>Pattern spacing</div>
              <input id="sSpace" type="range" min="0.7" max="1.5" value="1.0" step="0.1">
              <div class="tiny" id="sSpaceVal">Medium</div>
            </div>
            <div class="slider">
              <div>Mobility ratio</div>
              <input id="sMob" type="range" min="0.6" max="1.8" value="1.0" step="0.1">
              <div class="tiny" id="sMobVal">Balanced</div>
            </div>
          </div>
          <div>
            <div class="tiny"><b>Plain English:</b></div>
            <ul class="tiny" style="margin-top:6px">
              <li><b>Injection rate:</b> higher = faster blue curtain → earlier response (and earlier water at wells).</li>
              <li><b>Pattern spacing:</b> tighter lines = shorter travel → quicker front arrival.</li>
              <li><b>Mobility ratio:</b> worse (water “too mobile”) = fingering/wiggle → earlier local breakthrough.</li>
            </ul>
            <div class="tiny" style="margin-top:8px">Targets: keep <b>VRR ≈ 1</b> (balanced), watch WC post-BT, and align pattern with rock fabric when possible.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- RIGHT: Glossary + Watchouts -->
    <section class="card">
      <h2>For Dummies — What’s Happening?</h2>
      <div class="content">
        <p class="tiny"><b>Push:</b> Water acts like a <i>blue conveyor belt</i> pushing oil toward long green wells.</p>
        <p class="tiny"><b>Pressure:</b> Injection props up pressure so oil flows (aim for VRR ≈ 1 = balanced in vs out).</p>
        <p class="tiny"><b>Timing:</b> Oil rate bumps up first; later WC increases after breakthrough.</p>

        <h3 style="margin:12px 0 6px;font-size:1rem">Mini Glossary</h3>
        <ul class="tiny">
          <li><b>VRR:</b> Injected / Produced volume @ reservoir conditions. Target ≈ 1.</li>
          <li><b>Water cut (WC):</b> Fraction of water in produced liquids. 0% → all oil; 100% → all water.</li>
          <li><b>Breakthrough (BT):</b> First arrival of injected water at a producer (WC starts rising).</li>
          <li><b>Sweep:</b> Portion of reservoir contacted by the water curtain.</li>
        </ul>

        <h3 style="margin:12px 0 6px;font-size:1rem">What to Watch</h3>
        <ul class="tiny">
          <li><b>Heel vs toe:</b> Horizontals may see earlier water at the heel.</li>
          <li><b>Spacing:</b> Tighter line-drive = quicker response but potentially earlier WC.</li>
          <li><b>Mobility:</b> Poor mobility control = “wiggly” front → earlier localized BT.</li>
        </ul>
      </div>
    </section>

    <!-- BOTTOM: Charts -->
    <section class="card" style="grid-column:1/-1">
      <h2>Beginner Charts (auto-updates as it runs)</h2>
      <div class="content two-col">
        <div>
          <canvas id="chartOWC"></canvas>
          <div class="tiny" style="margin-top:6px">
            <span class="dot" style="background:var(--green)"></span> Oil Rate (relative)
            &nbsp; &nbsp;
            <span class="dot" style="background:var(--orange)"></span> Water Cut (0–1)
          </div>
        </div>
        <div>
          <canvas id="chartVRR"></canvas>
          <div class="tiny" style="margin-top:6px">
            <span class="dot" style="background:var(--green)"></span> VRR (aim ≈ 1.0)
          </div>
        </div>
        <div>
          <canvas id="chartFront"></canvas>
          <div class="tiny" style="margin-top:6px">
            <span class="dot" style="background:var(--blue)"></span> Front position (% distance across pattern)
          </div>
        </div>
        <div class="tiny">
          This is an illustrative toy model (not a simulator): front moves faster with higher injection and tighter spacing; worse mobility makes the front “wiggly” and can trigger earlier local BT; oil rises early then falls as WC grows; VRR tends toward a setting-driven balance near 1.
        </div>
      </div>
    </section>
  </div>

  <footer>Producer well & arrows are GREEN. Colors follow a seaborn-style palette.</footer>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>
/* ----------- Parameters & State ----------- */
const colors = {
  blue:"#4C72B0", green:"#55A868", orange:"#DD8452", red:"#C44E52",
  purple:"#8172B3", brown:"#937860", gray:"#8C8C8C"
};

let t    = 0;            // time (arb.)
let dt   = 0.25;         // step
let play = false;

let injRate  = 1.0;      // 0.5..1.8
let spacing  = 1.0;      // 0.7..1.5
let mobility = 1.0;      // 0.6..1.8

let frontPos = 5;        // %
let breakthroughAt = 55; // %
let wc = 0.0;            // 0..1
let qo = 0.0;            // rel
let vrr = 0.8;

const btnPlay  = document.getElementById('btnPlay');
const btnReset = document.getElementById('btnReset');
const frontEl  = document.getElementById('front');
const wiggleEl = document.getElementById('wiggle');
const lblStatus= document.getElementById('lblStatus');
const lblWC    = document.getElementById('lblWC');
const sInj     = document.getElementById('sInj');
const sSpace   = document.getElementById('sSpace');
const sMob     = document.getElementById('sMob');
const sInjVal  = document.getElementById('sInjVal');
const sSpaceVal= document.getElementById('sSpaceVal');
const sMobVal  = document.getElementById('sMobVal');

function updateSliderLabels(){
  sInjVal.textContent = (Number(sInj.value)).toFixed(1) + '×';
  const sp = Number(sSpace.value);
  sSpaceVal.textContent = sp<0.9 ? 'Tight' : sp>1.2 ? 'Wide' : 'Medium';
  const mr = Number(sMob.value);
  sMobVal.textContent = mr<0.9 ? 'Better' : mr>1.2 ? 'Worse' : 'Balanced';
}
updateSliderLabels();

sInj.addEventListener('input', ()=>{ injRate = Number(sInj.value); updateSliderLabels(); });
sSpace.addEventListener('input', ()=>{ spacing = Number(sSpace.value); updateSliderLabels(); recalcBreakthrough(); });
sMob.addEventListener('input', ()=>{ mobility = Number(sMob.value); updateSliderLabels(); });

function resetSim(){
  t = 0; frontPos = 5; wc = 0; qo = 0; vrr = 0.8;
  frontEl.style.left = frontPos + '%'; frontEl.style.width = '0%';
  wiggleEl.style.left = frontPos + '%'; wiggleEl.style.width = '0%';
  lblWC.textContent = 'Water Cut: ~0%';
  lblStatus.textContent = 'Status: BEFORE (front far; low WC)';
  play = false; btnPlay.textContent='▶ Play';
  owcChart.data.labels = []; owcChart.data.datasets[0].data = []; owcChart.data.datasets[1].data = [];
  vrrChart.data.labels = []; vrrChart.data.datasets[0].data = [];
  frontChart.data.labels = []; frontChart.data.datasets[0].data = [];
  owcChart.update(); vrrChart.update(); frontChart.update();
}
btnReset.addEventListener('click', resetSim);

function recalcBreakthrough(){
  breakthroughAt = 55 * spacing; // medium 55%, tight ~38.5%, wide ~82.5%
}
recalcBreakthrough();

btnPlay.addEventListener('click', ()=>{
  play = !play;
  btnPlay.textContent = play ? '⏸ Pause' : '▶ Play';
  if(play) requestAnimationFrame(step);
});

function step(){
  if(!play) return;

  const baseSpeed = 0.9;
  let speed = baseSpeed * injRate / spacing;
  const wiggleAmp = Math.max(0, (mobility - 1.0)) * 0.6;
  speed *= (1 + (Math.random()-0.5) * wiggleAmp);

  frontPos = Math.min(98, frontPos + speed);
  frontEl.style.left = frontPos + '%';
  frontEl.style.width = Math.max(0, frontPos - 5) + '%';
  wiggleEl.style.left = frontPos + '%';
  wiggleEl.style.width = Math.max(0, frontPos - 5) + '%';
  wiggleEl.style.opacity = 0.18 + Math.min(0.35, Math.max(0, (mobility-1)*0.25));

  const BT = breakthroughAt - Math.min(12, (mobility-1)*12);
  let wcTarget = 0;
  if(frontPos >= BT){
    const slope = 0.25 + Math.max(0, mobility-1)*0.35;
    wcTarget = 1/(1+Math.exp(-(frontPos - BT)*slope));
  }
  wc += (wcTarget - wc) * 0.12;

  const earlyBoost = Math.min(1, (frontPos/BT));
  const decline = (1 - 0.7*wc);
  qo = Math.max(0, 1.2 * earlyBoost * decline);

  const vrrTarget = Math.min(1.3, Math.max(0.6, 0.95 + (injRate-1)*0.35));
  vrr += (vrrTarget - vrr) * 0.08;

  lblWC.textContent = 'Water Cut: ~' + Math.round(wc*100) + '%';
  lblStatus.textContent = frontPos < BT
    ? 'Status: BEFORE (pressure support building; oil rising soon)'
    : 'Status: AFTER (breakthrough; manage WC & conformance)';

  t += dt;
  const tlab = t.toFixed(1);
  owcChart.data.labels.push(tlab);
  owcChart.data.datasets[0].data.push(qo);
  owcChart.data.datasets[1].data.push(wc);
  vrrChart.data.labels.push(tlab);
  vrrChart.data.datasets[0].data.push(vrr);
  frontChart.data.labels.push(tlab);
  frontChart.data.datasets[0].data.push(frontPos/100);

  [owcChart, vrrChart, frontChart].forEach(ch=>{
    if(ch.data.labels.length>200){ ch.data.labels.shift(); ch.data.datasets.forEach(ds=>ds.data.shift()); }
    ch.update('none');
  });

  requestAnimationFrame(step);
}

/* ----------- Charts ----------- */
const owcCtx   = document.getElementById('chartOWC').getContext('2d');
const vrrCtx   = document.getElementById('chartVRR').getContext('2d');
const frontCtx = document.getElementById('chartFront').getContext('2d');

const commonGrid = {color:'rgba(255,255,255,.06)'};
const labelCol   = '#e7edf7';
const tickCol    = '#b9c3d6';

const owcChart = new Chart(owcCtx, {
  type:'line',
  data:{labels:[], datasets:[
    {label:'Oil Rate (rel.)', data:[], borderColor:colors.green, tension:.25},
    {label:'Water Cut (0–1)', data:[], borderColor:colors.orange, borderDash:[6,4], tension:.25, yAxisID:'y2'}
  ]},
  options:{
    plugins:{legend:{labels:{color:labelCol}}},
    scales:{
      x:{title:{text:'Time',display:true,color:labelCol}, ticks:{color:tickCol}, grid:commonGrid},
      y:{title:{text:'Oil Rate (rel.)',display:true,color:labelCol}, min:0, max:1.4, ticks:{color:tickCol}, grid:commonGrid},
      y2:{title:{text:'Water Cut',display:true,color:labelCol}, position:'right', min:0, max:1, ticks:{color:tickCol}, grid:{display:false}}
    },
    elements:{point:{radius:0}}
  }
});

const vrrChart = new Chart(vrrCtx, {
  type:'line',
  data:{labels:[], datasets:[
    {label:'VRR', data:[], borderColor:colors.green, tension:.25}
  ]},
  options:{
    plugins:{legend:{labels:{color:labelCol}}},
    scales:{
      x:{title:{text:'Time',display:true,color:labelCol}, ticks:{color:tickCol}, grid:commonGrid},
      y:{title:{text:'VRR',display:true,color:labelCol}, min:0.6, max:1.3, ticks:{color:tickCol},
         grid:{...commonGrid, borderDash:[4,4]} }
    },
    elements:{point:{radius:0}}
  }
});

const frontChart = new Chart(frontCtx, {
  type:'line',
  data:{labels:[], datasets:[
    {label:'Front position (0–1)', data:[], borderColor:colors.blue, tension:.25}
  ]},
  options:{
    plugins:{legend:{labels:{color:labelCol}}},
    scales:{
      x:{title:{text:'Time',display:true,color:labelCol}, ticks:{color:tickCol}, grid:commonGrid},
      y:{title:{text:'Front Position',display:true,color:labelCol}, min:0, max:1, ticks:{color:tickCol}, grid:commonGrid}
    },
    elements:{point:{radius:0}}
  }
});
</script>
</body>
</html>